# Website builder application



## Project structure

This project follows a typical [Laravel app structure](https://laravel.com/docs/10.x/structure) (with the exception of the `generated-sites` directory). In broad strokes, most of the backend can be found within the `app` and `database` directories, routes can be found within the `routes` directory, and most of the frontend can be found within the `resources` directory.

The `generated-sites` directory contains a [Vue.js app](https://vuejs.org/guide/essentials/application) that can be run separately from the main application. Within this directory are components for each of the generated website pages (in the `generated-site/src/pages/` directory). These pages can be generated in one of two ways: through the standalone `generated-sites` Vue.js app (via the components in the `generated-site/src/views/` directory), or through the main Laravel app (via the components in the `resources/js/Pages/GeneratedSite/` directory). When accessed through the standalone app, these pages draw data from the `generated-site/src/data/` directory. When accessed through the main app, these pages draw data from the local database. The reason for packaging these pages within their own sub-app is that it makes it easier to export a user's generated website as a standalone app. 

* `app/`
  * `app/Console/Kernel.php` defines artisan commands
  * `app/Exceptions/Handler.php` defines exception handling
  * `app/Http/`
    * `app/Http/Controllers/` request handling logic (these files contain the bulk of backend logic)
    * `app/Http/Middleware/` middleware for request processing
    * `app/Http/Requests/` custom request classes, mostly used for validation definitions
  * `app/Models/` [Eloquent](https://laravel.com/docs/10.x/eloquent) models which represent database tables
  * `app/Providers/` service providers
* `bootstrap/` framework files
* `config/` configuration files
* `database/`
  * `database/factories/` factories that can be used to generate [faked](https://github.com/FakerPHP/Faker) models
  * `database/migrations/` migrations that define the database structure
  * `database/seeders/DatabaseSeeder.php` the seeder used to insert a test property into the database
* `generated-site/`
  * `generated-site/node_modules/` sub-app JavaScript packages (generated by the `npm install` command)
  * `generated-site/src/`
    * `generated-site/src/assets/generatedSite.css` the stylesheet for the sub-app
    * `generated-site/src/components/` reusable components
    * `generated-site/src/data/` the images and data used to generate pages when the sub-app stands alone
    * `generated-site/src/pages/` the generated website pages
    * `generated-site/src/router/index.js` the [Vue Router](https://router.vuejs.org/introduction.html) used when the sub-app stands alone
    * `generated-site/src/stores/store.js` a single [Pinia Store](https://pinia.vuejs.org/introduction.html) used to distribute data when the sub-app stands alone
    * `generated-site/src/views/` components used to generate pages when the sub-app stands alone
* `public/` entry point of the main-app
* `node_modules/` main-app JavaScript packages (generated by the `npm install` command)
* `resources/`
  * `resources/css/app.css` the stylesheet for the main-app
  * `resources/js/`
    * `resources/js/Components/` smaller reusable components
    * `resources/js/Layout/` reusable components used to define standard page layouts
    * `resources/js/Pages/` page components reachable by [Inertia routes](https://inertiajs.com/routing) (these files contain the bulk of frontend logic)
  * `resources/views/app.blade.php` a single [Blade template](https://laravel.com/docs/10.x/blade) (as this project uses a [Vue.js SPA](https://vuejs.org/guide/extras/ways-of-using-vue#single-page-application-spa))
* `routes/` route definitions (`web.php` containing the most relevant ones)
* `storage/` stored files (user generated files are stored in `storage/app/public`)
* `tests/` automatic test suite (composed of feature tests)
* `vendor/` PHP packages (generated by the `composer install` command)



## Pre-requisite technologies

### PHP
* This is the programming language that the Laravel framework is built on.
* It is used throughout the backend of the project.
* It can be downloaded [here](https://www.php.net/downloads.php).
* Alternatively, it can be installed from command line:
  * On Linux: `sudo apt-get install php`
  * On Windows (using [Chocolatey](https://chocolatey.org/install)):  `choco install php`
* Note that this project requires version 8.1 or newer.
* It may also be necessary to enable the following extensions in `php.ini`:
  * `mbstring`
  * `curl`
  * `fileinfo`
  * `openssl`
  * `pdo_mysql`
  * `xsl`
  * `zip`

### Composer
* This is a tool used to manage PHP packages.
* It can be used to automatically install all PHP packages used throughout the project.
* It can be installed by following the instructions found [here](https://getcomposer.org/doc/00-intro.md).
* Note that Composer requires PHP to already be installed.

### Node.js
* This is a JavaScript runtime environment.
* It can be used to run the application such that it is available locally.
* The latest LTS version can be downloaded [here](https://nodejs.org/en/download).
* This will automatically install the NPM CLI as well.

### MySQL Server
* This is a database management system.
* It can be used to set up a local database for the application can connect to.
* The latest version for each operating system can be downloaded [here](https://dev.mysql.com/downloads/mysql/).
* This will automatically install the MySQL CLI as well.



## How to set up the application for the first time

> In the following steps, you will need to create a database, a user, and a password for that user. In these instructions I will assume that these are named `wb_database`, `wb_user`, and `wb_password` respectively. Please replace these placeholders with your own values when you encounter them.

> In the following steps, you will be asked to enter two API keys: one for the Google Maps API (instructions [here](https://developers.google.com/maps/documentation/embed/quickstart#create-project)), and one for the Google Fonts API (instructions [here](https://developers.google.com/fonts/docs/developer_api#APIKey)). To generate these API keys you will need to create a Google Cloud account and enter billing information. However, your account will not be charged as both of these APIs are free to use. In these instructions I will assume that these keys are named `maps_api_key` and `fonts_api_key` respectively. Please replace these placeholders with your own values when you encounter them.

### Create a local database

* Open the MySQL CLI and log in.
  * On Windows you can find this CLI in your Start menu under the `MySQL` folder.
  * On Linux you can open this CLI by running `sudo mysql -u root -p` from command line.
* Create a database by running `CREATE DATABASE wb_database;`.
* Create a user by running `CREATE USER 'wb_user'@'localhost' IDENTIFIED BY 'wb_password';`.
* Allow that user full access to your database by running `GRANT ALL PRIVILEGES ON wb_database.* to wb_user@localhost;`.
* Apply these permission changes by running `FLUSH PRIVILEGES;`.

### Configure localhost domain names

* Open your `/etc/hosts` file with administrator privileges.
  * On Windows the full path will be `C:\Windows\System32\drivers\etc\hosts`.
* Add the following line to the end of the file: `127.0.0.1 websitebuilder.ftb.sites`.
* Add the following line to the end of the file: `127.0.0.1 testhotel.ftb.sites`.
* Add subsequent lines in this format for any subdomains you wish to use in testing.
  * For example, if you intend to test that the subdomain for the "Test Hotel" seeder property can be changed to `altsubdomain`, add the following line: `127.0.0.1 altsubdomain.ftb.sites`.
  * Manual definition of all subdomains is needed when testing on a localhost as, unlike DNS records, `/etc/hosts` does not permit wildcard domains.
* Save your changes to `/etc/hosts`, replacing the previous file.

### Set environment variables

* Navigate to `src/ftb-website-builder` and create a `.env` file.
* Open `.env` in your preferred IDE or text editor.
* Copy the contents of `.env.example` into `.env`.
* Change `DB_DATABASE=` to `DB_DATABASE=wb_database`.
* Change `DB_USERNAME=` to `DB_USERNAME="wb_user"`.
* Change `DB_PASSWORD=` to `DB_PASSWORD="wb_password"`.
* Change `VITE_GOOGLE_MAPS_API_KEY=` to `VITE_GOOGLE_MAPS_API_KEY="maps_api_key"`.
* Change `VITE_GOOGLE_FONTS_API_KEY=` to `VITE_GOOGLE_FONTS_API_KEY="fonts_api_key"`.

### Prepare and run the application

* In your preferred CLI, navigate to `src/ftb-website-builder`.
* Install all necessary PHP packages by running `composer install`.
* Install all necessary JavaScript packages by running `npm install`.
* Create a symbolic link necessary for image storage by running `php artisan storage:link`.
* Generate the `APP_KEY` environment variable by running `php artisan key:generate`.
* Prepare the database by running `npm run reseed`.
* Prepare the test images by copying them into the `src/ftb-website-builder/storage/app/public/images/1/` directory.
  * The test images can be found in the `src/ftb-website-builder/generated-site/src/data/images/` directory.
* Start the application by running `npm run start`.
* In your preferred web browser, navigate to `http://websitebuilder.ftb.sites:8000`.
* You can now log in using the credentials for the fully populated "Test Hotel" seeder property.
  * The seeder defines the username as `testhotel@example.com` and the password as `testhotelpass`.



## How to run the automatic test suite

* Make sure all instructions above have been followed and that the application is currently running.
* In your preferred CLI, navigate to `src/ftb-website-builder`.
* Run the command `php artisan test --testsuite=Feature`.
  * It will take roughly 10 seconds to run the test suite.
  * The output of this command will clearly show whether each test has passed or failed.



## How to run the generated website as a standalone app

* In your preferred CLI, navigate to `src/ftb-website-builder/generated-site`.
* Install all necessary JavaScript packages by running `npm install`.
* Start the application by running `npm run dev`.
* In your preferred web browser, navigate to the local URL for the app.
  * This will be made clear in the output at command line. 
  * By default, this URL will be `http://localhost:5173`.
  * However, if the main app was already running then the URL will default to `http://localhost:5174/`.
* You will need to refresh the page to see any changes made in the `generated-site/src/data/` directory while the app is running.



## Recommendations for developers

### Useful technologies
| Technology          | Usage                                                    | Installation                                                         |
|---------------------|----------------------------------------------------------|----------------------------------------------------------------------|
| **PhpStorm**        | The primary IDE used throughout development.             | [Link](https://www.jetbrains.com/phpstorm/download/#section=windows) |
| **Vue.js devtools** | A browser extension used for frontend debugging.         | [Link](https://devtools.vuejs.org/guide/installation.html)           |
| **MySQL Workbench** | A useful interface for interacting with local databases. | [Link](https://dev.mysql.com/downloads/workbench/)                   |

### External documentation

##### Integral technologies:
* MySQL Server [documentation](https://dev.mysql.com/doc/refman/8.3/en/).
* PHP [documentation](https://www.php.net/manual/en/).
* Laravel 10 [documentation](https://laravel.com/docs/10.x), including Eloquent ORM [documentation](https://laravel.com/docs/10.x/eloquent).
* Inertia [documentation](https://inertiajs.com/).
* Vue 3 [documentation](https://vuejs.org/guide/introduction.html).
* Vue Router [documentation](https://router.vuejs.org/guide/) and [GitHub](https://github.com/vuejs/router).
* Pinia Store [documentation](https://pinia.vuejs.org/getting-started.html).
* Preline UI component library [documentation](https://preline.co/docs/index.html) and [demos](https://preline.co/examples.html).
* Tailwind 3 [documentation](https://tailwindcss.com/docs/installation).
* PHPUnit [documentation](https://docs.phpunit.de/en/11.0/).

##### Minor packages:
* PHP ICO library [GitHub](https://github.com/chrisbliss18/php-ico?tab=readme-ov-file).
* Vue 3 carousel component [documentation](https://ismail9k.github.io/vue3-carousel/getting-started.html).
* Vue 3 star-rating component [GitHub](https://github.com/craigh411/vue-star-rating) and [demos](https://codepen.io/craigh411/pen/abNXVQN).
* Vue 3 colour-picker component [GitHub](https://github.com/kleinfreund/vue-accessible-color-picker) and [demo](https://vue-accessible-color-picker.netlify.app/).
* TinyColor package [GitHub](https://github.com/bgrins/TinyColor).
* Google Maps Embed API [documentation](https://developers.google.com/maps/documentation/embed/get-started).
* Google Fonts API [documentation](https://developers.google.com/fonts/docs/getting_started) and [font list](https://fonts.google.com/).
* Faker library [GitHub](https://github.com/FakerPHP/Faker) and [documentation](https://fakerphp.github.io/).

